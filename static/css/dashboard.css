@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Teko:wght@300;400;600&family=Press+Start+2P&display=swap');

        /* --- THEME VARIABLES --- */
        :root {
            --void: #050505;
            --panel-bg: rgba(15, 15, 15, 0.7);
            --panel-border: rgba(255, 255, 255, 0.08);
            --sidebar-bg: rgba(5, 5, 5, 0.6);
            --text-main: #f5f5f5;
            --text-muted: #a3a3a3;
            --getsuga: #ff6b00;
            --reishi: #00d2ff;
            --danger: #ef4444;
            --scanline-opacity: 0.02;
            --widget-bg: rgba(0, 0, 0, 0.8);
        }

        /* LIGHT MODE (Seireitei Day) */
        body.light-mode {
            --void: #f0f2f5;
            --panel-bg: rgba(255, 255, 255, 0.85);
            --panel-border: rgba(0, 0, 0, 0.08);
            --sidebar-bg: rgba(245, 245, 245, 0.85);
            --text-main: #1a1a1a;
            --text-muted: #666666;
            --scanline-opacity: 0.01;
            --widget-bg: rgba(255, 255, 255, 0.95);
        }

        body {
            background-color: var(--void);
            color: var(--text-main);
            font-family: 'JetBrains Mono', monospace;
            overflow: hidden; 
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        /* Mobile Override */
        @media (max-width: 768px) {
            body { overflow: auto; }
        }

        /* --- UTILS --- */
        .font-teko { font-family: 'Teko', sans-serif; }
        .font-arcade { font-family: 'Press Start 2P', cursive; }
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        
        /* --- VISUAL EFFECTS --- */
        .scanlines {
            position: fixed; inset: 0; pointer-events: none; z-index: 0;
            background: linear-gradient(to bottom, rgba(0,0,0,0) 50%, rgba(0,0,0,var(--scanline-opacity)) 50%);
            background-size: 100% 3px;
        }

        #three-canvas {
            position: fixed; inset: 0; z-index: -1;
            opacity: 0.6; pointer-events: none;
            transition: opacity 0.3s;
        }
        body.light-mode #three-canvas { opacity: 0.4; filter: invert(1) hue-rotate(180deg); }

        /* Glassmorphism Cards */
        .glass-card {
            background: var(--panel-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid var(--panel-border);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .glass-card:hover {
            border-color: var(--reishi);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        /* Floating Widgets */
        .floating-widget {
            position: fixed;
            background: var(--widget-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--panel-border);
            border-radius: 8px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
            z-index: 100;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transition: height 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s, transform 0.3s;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
            max-width: 90vw; /* Mobile safety */
        }
        
        .widget-header {
            cursor: grab;
            user-select: none;
        }
        .widget-header:active { cursor: grabbing; }

        .floating-widget.minimized {
            height: 48px !important;
            width: 200px !important;
        }
        
        .floating-widget.minimized .widget-content {
            display: none;
        }

        /* --- SHAPES --- */
        .clip-angle { clip-path: polygon(12px 0, 100% 0, 100% calc(100% - 12px), calc(100% - 12px) 100%, 0 100%, 0 12px); }
        .clip-btn { clip-path: polygon(6px 0, 100% 0, 100% calc(100% - 6px), calc(100% - 6px) 100%, 0 100%, 0 6px); }

        /* --- ANIMATIONS --- */
        .search-expand {
            width: 0; opacity: 0; transition: all 0.3s ease;
        }
        .search-container.active .search-expand {
            width: 180px; opacity: 1; padding-left: 10px;
        }
        
        #sidebar { transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .sidebar-label { transition: opacity 0.2s, transform 0.2s; white-space: nowrap; }
        #sidebar.collapsed { width: 72px; }
        #sidebar.collapsed .sidebar-label { opacity: 0; transform: translateX(-10px); pointer-events: none; position: absolute; }

        /* Widget Pulse */
        .pomo-pulse { animation: pulse-border 2s infinite; }
        @keyframes pulse-border {
            0% { border-color: var(--panel-border); }
            50% { border-color: var(--danger); box-shadow: 0 0 10px rgba(239, 68, 68, 0.3); }
            100% { border-color: var(--panel-border); }
        }

        /* Toast */
        #toast-container {
            position: fixed; bottom: 20px; right: 20px; z-index: 200;
            display: flex; flex-direction: column; gap: 10px; pointer-events: none;
        }
        .toast {
            background: var(--panel-bg);
            border: 1px solid var(--panel-border);
            padding: 12px 20px;
            color: var(--text-main);
            font-size: 12px;
            clip-path: polygon(10px 0, 100% 0, 100% calc(100% - 10px), calc(100% - 10px) 100%, 0 100%, 0 10px);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            pointer-events: auto;
            border-left: 4px solid var(--reishi);
            backdrop-filter: blur(10px);
        }
        .toast.show { transform: translateX(0); }

        /* Mobile Nav */
        .mobile-nav-item.active { color: var(--getsuga); }
        
        /* Dropdown Theme Fix */
        .dropdown-menu {
            background-color: var(--panel-bg);
            border: 1px solid var(--panel-border);
            color: var(--text-main);
        }